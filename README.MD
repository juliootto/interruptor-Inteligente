# Interruptor Inteligente WiFi com ESP8266 (Master/Slave)

![Vers√£o](https://img.shields.io/badge/vers√£o-1.0-blue)
![Plataforma](https://img.shields.io/badge/Plataforma-PlatformIO-orange)
![Licen√ßa](https://img.shields.io/badge/licen√ßa-MIT-green)

Projeto de um interruptor inteligente (smart switch) baseado no microcontrolador ESP8266. Permite o controle de um rel√© via rede Wi-Fi atrav√©s de uma API HTTP simples e inclui um modo de opera√ß√£o Mestre/Escravo para sincronizar m√∫ltiplos interruptores.

Para operar esse interruptor pode-se usar o aplicativo Automa√ß√£o Resid√™ncial disponivel em [https://github.com/juliootto/automacao_residencial](https://github.com/juliootto/automacao_residencial).

Este projeto est√° configurado para ser compilado e gerido com **PlatformIO** no **Visual Studio Code**.

## ‚ú® Funcionalidades

* **Controle via Wi-Fi**: Ligue e desligue qualquer aparelho eletr√≥nico atrav√©s da sua rede local.
* **Servidor Web Integrado**: O ESP8266 hospeda um servidor web para receber comandos HTTP.
* **Modo Mestre/Escravo**: Configure um dispositivo como "Mestre" e outros como "Escravos" que ir√£o espelhar o estado do mestre automaticamente.
* **API HTTP Simples**: Controle o interruptor facilmente atrav√©s de requisi√ß√µes GET.
* **Fun√ß√£o Sleep Timer**: Programe o interruptor para se desligar automaticamente ap√≥s um tempo determinado.
* **Configura√ß√£o Facilitada**: Usa a biblioteca **WiFiManager** para configurar as credenciais de Wi-Fi atrav√©s de um portal web na primeira utiliza√ß√£o.
* **IP Est√°tico**: Permite a configura√ß√£o de um endere√ßo IP fixo para f√°cil acesso na rede.

## üìã Pr√©-requisitos

* **Visual Studio Code**: O editor de c√≥digo onde o projeto ser√° desenvolvido.
* **Extens√£o PlatformIO IDE**: A extens√£o para o VS Code que gere todo o processo de compila√ß√£o, depend√™ncias e upload.

## üõ†Ô∏è Hardware Necess√°rio

* 1x Placa de desenvolvimento com **ESP8266** (NodeMCU, Wemos D1 Mini, etc.).
* 1x M√≥dulo Rel√© de 5V compat√≠vel com microcontroladores de 3.3V.
* 1x Fonte de alimenta√ß√£o de 5V para o ESP8266 e o m√≥dulo rel√©.
* Jumpers para as conex√µes.

**Conex√£o Padr√£o:**
O pino de controle do rel√© (`relayPin`) est√° configurado por padr√£o para o pino `D6` (GPIO12).

## üìö Bibliotecas e Depend√™ncias

A gest√£o das bibliotecas √© feita automaticamente pelo PlatformIO atrav√©s do ficheiro `platformio.ini`. N√£o √© necess√°rio instalar nada manualmente.

O ficheiro `platformio.ini` deste projeto deve ser semelhante a este:

```ini
[env:nodemcuv2]
platform = espressif8266
board = nodemcuv2
framework = arduino
monitor_speed = 9600
lib_deps =
    tzapu/WiFiManager @ 2.0.16-rc2
```

## ‚öôÔ∏è Instala√ß√£o e Configura√ß√£o

**1. Clone o Reposit√≥rio**
```bash
git clone [https://github.com/juliootto/interruptor-Inteligente.git](https://github.com/juliootto/interruptor-Inteligente.git)
cd seu-repositorio
```

**2. Abra o Projeto no VS Code**
* Abra o Visual Studio Code.
* V√° em `File > Open Folder...` (ou `Ficheiro > Abrir Pasta...`) e selecione a pasta do projeto que acabou de clonar.
* O PlatformIO dever√° reconhecer o projeto automaticamente.

**3. Edite o Ficheiro de Configura√ß√£o**
* Na estrutura de pastas, abra e edite o ficheiro `include/ConfigInterruptor.h`.
* Altere os valores de `MESTRE`, `IP_X` e `IP_MESTRE_X` de acordo com a sua necessidade.

```cpp
// include/ConfigInterruptor.h

#ifndef CONFIG_INTERRUPTOR_H
#define CONFIG_INTERRUPTOR_H

// --- MODO DE OPERA√á√ÉO ---
// Defina como 'true' para o dispositivo Mestre e 'false' para dispositivos Escravos.
#define MESTRE true

// --- CONFIGURA√á√ÉO DE REDE ---
// Defina o IP est√°tico para este dispositivo.
#define IP_1 192
#define IP_2 168
#define IP_3 0
#define IP_4 100

// Defina o IP do dispositivo Mestre (s√≥ √© usado se MESTRE = false).
#define IP_MESTRE_1 192
#define IP_MESTRE_2 168
#define IP_MESTRE_3 0
#define IP_MESTRE_4 101 // Exemplo de IP do Mestre

// ...
#endif // CONFIG_INTERRUPTOR_H
```

> **Aviso de Seguran√ßa**: Tenha cuidado para n√£o enviar informa√ß√µes sens√≠veis (como senhas de Wi-Fi, se as adicionar) para um reposit√≥rio p√∫blico. O uso do WiFiManager ajuda a evitar isso.

**4. Compile e Fa√ßa o Upload**
* Conecte a sua placa ESP8266 ao computador.
* Na barra de status inferior do VS Code, clique no √≠cone de seta (‚Üí) que corresponde ao comando "PlatformIO: Upload".
* O PlatformIO ir√° compilar o projeto, instalar as depend√™ncias e carregar o firmware na placa.

**5. Configure o Wi-Fi (Primeira Vez)**
* O processo permanece o mesmo: O ESP8266 criar√° um Access Point chamado **"InterruptorAP"**.
* Conecte-se a ele e aceda a `192.168.4.1` no navegador para configurar a sua rede Wi-Fi.

## üöÄ Como Usar (API)

Ap√≥s a configura√ß√£o, pode controlar o interruptor enviando requisi√ß√µes HTTP GET para o IP do seu ESP8266.

* **Ligar o Rel√©:** `http://192.168.0.100/relay?do=on`
* **Desligar o Rel√©:** `http://192.168.0.100/relay?do=off`
* **Verificar o Status:** `http://192.168.0.100/getStatus`
* **Agendar Desligamento (ex: 1 min):** `http://192.168.0.100/sleep?time=60000`

## üëë Modo de Funcionamento (Mestre/Escravo)

### Modo Mestre
* **Configura√ß√£o**: `define MESTRE true` no ficheiro `include/ConfigInterruptor.h`.
* **Comportamento**: Atua de forma independente e responde aos comandos da API.

### Modo Escravo
* **Configura√ß√£o**: `define MESTRE false` e configure o `IP_MESTRE` corretamente.
* **Comportamento**: Ignora comandos da API e espelha o estado do dispositivo Mestre.

*Este projeto foi desenvolvido por Julio Otto.*